<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="2.4. Model evaluation" href="model_evaluation.html" /><link rel="prev" title="2.2. Data" href="data.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>2.3. Pipeline - julearn documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">julearn  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-scroll"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/julearn_logo_it.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">julearn  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">1. Getting started</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">2. What you really need to know</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cross_validation.html">2.1. Why cross validation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">2.2. Data</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">2.3. Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_evaluation.html">2.4. Model evaluation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../selected_deeper_topics/index.html">3. Selected deeper topics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../selected_deeper_topics/confound_removal.html">3.1. Cross-validation consistent Confound Removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selected_deeper_topics/HPT.html">3.2. Hyper Parameter Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selected_deeper_topics/model_inspect.html">3.3. Inspecting Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selected_deeper_topics/stacked_models.html">3.4. Stacking Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selected_deeper_topics/CBPM.html">3.5. Connectome-based Predictive Modeling (CBPM)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../available_pipeline_steps.html">4. Overview of available Pipeline Steps</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../auto_examples/index.html">5. Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/00_starting/index.html">Starting with julearn</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_combine_pandas.html">Working with pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_simple_binary_classification.html">Simple Binary Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/run_grouped_cv.html">Grouped CV.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_cm_acc_multiclass.html">Multiclass Classification.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_stratified_kfold_reg.html">Stratified K-fold CV for regression analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/00_starting/plot_example_regression.html">Regression Analysis</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/01_model_comparison/index.html">Model Comparison</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/01_model_comparison/run_simple_model_comparison.html">Simple Model Comparison</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/02_inspection/index.html">Inspection</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/run_binary_inspect_folds.html">Inspecting the fold-wise predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_inspect_random_forest.html">Inspecting Random Forest models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_groupcv_inspect_svm.html">Inspecting SVM models.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/02_inspection/plot_preprocess.html">Preprocessing with variance threshold, zscore and PCA</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/03_complex_models/index.html">Complex Models</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_apply_to_target.html">Transforming target variable with z-score.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_stacked_models.html">Stacking Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_hyperparameter_tuning.html">Tuning Hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/03_complex_models/run_example_pca_featsets.html">Regression Analysis</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/04_confounds/index.html">Confounds</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/04_confounds/run_return_confounds.html">Return Confounds in Confound Removal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/04_confounds/plot_confound_removal_classification.html">Confound Removal (model comparison)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../auto_examples/05_customization/index.html">Customization</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../auto_examples/05_customization/run_custom_scorers_regression.html">Custom Scoring Function for Regression</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">6. Reference</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/main.html">6.1. Main API</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.run_cross_validation.html">julearn.run_cross_validation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/pipeline.html">6.2. Pipeline</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.PipelineCreator.html">julearn.PipelineCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.TargetPipelineCreator.html">julearn.TargetPipelineCreator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.pipeline.JuTargetPipeline.html">julearn.pipeline.JuTargetPipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.pipeline.pipeline_creator.Step.html">julearn.pipeline.pipeline_creator.Step</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/model_selection.html">6.3. Model Selection</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.StratifiedGroupsKFold.html">julearn.model_selection.StratifiedGroupsKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.RepeatedStratifiedGroupsKFold.html">julearn.model_selection.RepeatedStratifiedGroupsKFold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.StratifiedBootstrap.html">julearn.model_selection.StratifiedBootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.get_searcher.html">julearn.model_selection.get_searcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.list_searchers.html">julearn.model_selection.list_searchers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.register_searcher.html">julearn.model_selection.register_searcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.model_selection.reset_searcher_register.html">julearn.model_selection.reset_searcher_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/base.html">6.4. Base</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.JuBaseEstimator.html">julearn.base.JuBaseEstimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.JuTransformer.html">julearn.base.JuTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.WrapModel.html">julearn.base.WrapModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ColumnTypes.html">julearn.base.ColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ColumnTypesLike.html">julearn.base.ColumnTypesLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.change_column_type.html">julearn.base.change_column_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.get_column_type.html">julearn.base.get_column_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.make_type_selector.html">julearn.base.make_type_selector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.base.ensure_column_types.html">julearn.base.ensure_column_types</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/inspect.html">6.5. Inspect</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.inspect.preprocess.html">julearn.inspect.preprocess</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/models.html">6.6. Models</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.dynamic.DynamicSelection.html">julearn.models.dynamic.DynamicSelection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.list_models.html">julearn.models.list_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.get_model.html">julearn.models.get_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.register_model.html">julearn.models.register_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.models.reset_model_register.html">julearn.models.reset_model_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/scoring.html">6.7. Scoring</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.get_scorer.html">julearn.scoring.get_scorer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.list_scorers.html">julearn.scoring.list_scorers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.register_scorer.html">julearn.scoring.register_scorer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.reset_scorer_register.html">julearn.scoring.reset_scorer_register</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.check_scoring.html">julearn.scoring.check_scoring</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/scoring.html#module-julearn.scoring.metrics">6.8. Scoring Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.scoring.metrics.r2_corr.html">julearn.scoring.metrics.r2_corr</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/transformers.html">6.9. Transformers</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.DropColumns.html">julearn.transformers.DropColumns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.ChangeColumnTypes.html">julearn.transformers.ChangeColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.SetColumnTypes.html">julearn.transformers.SetColumnTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.FilterColumns.html">julearn.transformers.FilterColumns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.CBPM.html">julearn.transformers.CBPM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.JuColumnTransformer.html">julearn.transformers.JuColumnTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.confound_remover.ConfoundRemover.html">julearn.transformers.confound_remover.ConfoundRemover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.list_transformers.html">julearn.transformers.list_transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.get_transformer.html">julearn.transformers.get_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.register_transformer.html">julearn.transformers.register_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.reset_transformer_register.html">julearn.transformers.reset_transformer_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/transformers.html#module-julearn.transformers.target">6.10. Target Transformers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.JuTransformedTargetModel.html">julearn.transformers.target.JuTransformedTargetModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.JuTargetTransformer.html">julearn.transformers.target.JuTargetTransformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.TargetConfoundRemover.html">julearn.transformers.target.TargetConfoundRemover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.TransformedTargetWarning.html">julearn.transformers.target.TransformedTargetWarning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.get_target_transformer.html">julearn.transformers.target.get_target_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.list_target_transformers.html">julearn.transformers.target.list_target_transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.register_target_transformer.html">julearn.transformers.target.register_target_transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.transformers.target.reset_target_transformer_register.html">julearn.transformers.target.reset_target_transformer_register</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/utils.html">6.11. Utils</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.logger.html">julearn.utils.logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.configure_logging.html">julearn.utils.configure_logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.raise_error.html">julearn.utils.raise_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.warn_with_log.html">julearn.utils.warn_with_log</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/utils.html#module-julearn.utils.typing">6.12. Typing</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.JuEstimatorLike.html">julearn.utils.typing.JuEstimatorLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLike.html">julearn.utils.typing.EstimatorLike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFit1.html">julearn.utils.typing.EstimatorLikeFit1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFit2.html">julearn.utils.typing.EstimatorLikeFit2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.utils.typing.EstimatorLikeFity.html">julearn.utils.typing.EstimatorLikeFity</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/prepare.html">6.13. Prepare</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.prepare.prepare_input_data.html">julearn.prepare.prepare_input_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/julearn.prepare.check_consistency.html">julearn.prepare.check_consistency</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">7. Contributing to julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintaining.html">8. Maintaining julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">9. What’s new</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="pipeline">
<span id="pipeline-usage"></span><h1><span class="section-number">2.3. </span>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this heading">#</a></h1>
<p>So far we know how to pass input data to <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a>
(see <a class="reference internal" href="data.html#data-usage"><span class="std std-ref">Data</span></a>). Now, we will have a look at the implementation of
basic machine learning pipelines.</p>
<p>A machine learning pipeline is a process of automating the workflow of a
building a model. It can be thought of as a combination of pipes and
filters. At the pipeline starting point, the raw data is fed into this
pipeline. Different  filters inside the pipeline modify the data. The output of
a machine pipeline is the predictions of that data. But before using the pipeline
to predict new data, the pipeline has to be trained on data. We call
this, as scikit-learn does, _fitting_ the pipeline.</p>
<p>Importantly, since we want to test how well our model _predicts_ new data, we
cannot predict using the same data we used for _fitting_. Thus, we need to have
separate data for fitting and predicting. This is where cross validation comes
in handy. Cross validation is a technique to split the data into a training and
testing data set. The training data set is used to fit the pipeline, while the
testing data set is used to predict the data. The predictions are then compared
to the true values of the testing data set, obtaining an estimation of the
prediction performance of the model.</p>
<p>Julearn aims to provide a user-friendly way to build and evaluate complex
machine learning pipelines. The <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> function is the
entry point to safely evaluate pipelines. We first have a look at the most
basic pipeline, only consisting of a machine learning algorithm. Then we will
make the pipeline incrementally more complex.</p>
<section id="basic-cross-validation-with-julearn">
<span id="basic-cv"></span><h2>Basic cross validation with Julearn<a class="headerlink" href="#basic-cross-validation-with-julearn" title="Permalink to this heading">#</a></h2>
<p>One important aspect when building machine learning models is the selection of
a learning algorithm. This can be specified in <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a>
by setting the <code class="docutils literal notranslate"><span class="pre">model</span></code> parameter . This parameter can be any scikit-learn
compatible learning algorithms. However, Julearn provides a built-in list of
<a class="reference internal" href="../available_pipeline_steps.html#available-models"><span class="std std-ref">Models (Estimators)</span></a> that can be specified just by a name. For example, we
can simply set <code class="docutils literal notranslate"><span class="pre">model==&quot;svm&quot;</span></code> to use a support vector machine (SVM) <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You will notice that this code indicates an extra parameter <code class="docutils literal notranslate"><span class="pre">problem_type</span></code>.
This is because in machine learning, one can distinguish between regression
problems -when predicting a continous outcome- and classification problems
-for discrete class label predictions-. Therefore,
<a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> additionally needs to know which problem type we
are interested in. This is done by specifying the parameter <code class="docutils literal notranslate"><span class="pre">problem_type</span></code>.
The possible values are <code class="docutils literal notranslate"><span class="pre">classification</span></code> and <code class="docutils literal notranslate"><span class="pre">regression</span></code> and importantly,
there is no default specified, so you have to explicitely set it. In the
example we are interested in predicting the species
(see <code class="docutils literal notranslate"><span class="pre">y</span></code> in <a class="reference internal" href="data.html#data-usage"><span class="std std-ref">Data</span></a>), i.e. a discrete class label. Therefore,
the <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> is <code class="docutils literal notranslate"><span class="pre">classification</span></code>.</p>
<p>Et voilà, your first machine learning pipeline is ready to go.</p>
</section>
<section id="feature-preprocessing">
<h2>(Feature) preprocessing<a class="headerlink" href="#feature-preprocessing" title="Permalink to this heading">#</a></h2>
<p>There are cases in which the input data, and in particular the features,
should be transformed before passing them to the learning algorithm. One
scenario can be that certain learning algorithms need the features in a
specific form, for example in standardized form, so that the data resemble a
normal distribution. This can be achieved by first z-scoring (or standard
scaling) the features (see <a class="reference internal" href="../available_pipeline_steps.html#available-scalers"><span class="std std-ref">Scalers</span></a>).</p>
<p>Importantly, in a machine learning workflow all transformations done to the
data have to be done in a cv-consistent way. That means, that one should do
steps like feature preprocessing on the training data of each respective cross
validation and then only apply the parameters of the transformation to the
validation data. One should <strong>never</strong> do preprocessing on the entire dataset
and then do cross validation on the already preprocessed features (or more
generally transformed data) because this leads to leakage of information from
the validation data into the model. This is exactly where
<a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> comes in handy, because you can simply add your
wished preprocessing step (<a class="reference internal" href="../available_pipeline_steps.html#available-transformers"><span class="std std-ref">Transformers</span></a>) and it
takes care of doing the respective transformations in a cv-consistent manner.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">preprocess</span><span class="o">=</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Learning algorithms (what we specified in the <cite>model</cite> parameter), are
estimators. Preprocessing steps however, are usually transformers, because
they transform the input data in a certain way. Therefore the parameter
description in the api of <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a>,
defines valid input for the <cite>preprocess</cite> parameter as <cite>TransformerLike</cite>.</p>
<dl class="simple">
<dt>preprocess<span class="classifier">str, TransformerLike or list or PipelineCreator | None</span></dt><dd><p>Transformer to apply to the features. If string, use one of the
available transformers. If list, each element can be a string or
scikit-learn compatible transformer. If None (default), no
transformation is applied.</p>
</dd>
</dl>
</div>
<p>But what if we want to add more pre-processing steps?
An examplar scenario can be, that there are many features available, so that one
wants to first reduce the dimensionality of the features before passing them
to the learning algorithm. A commonly used approach is a principal component
analysis (PCA, see <a class="reference internal" href="../available_pipeline_steps.html#available-decompositions"><span class="std std-ref">Decomposition</span></a>). If we nevertheless
want to keep our previously applied z-scoring, we can simply add the PCA as
another preprocessing step as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">preprocess</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span> <span class="s2">&quot;pca&quot;</span><span class="p">],</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span>
    <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is nice, but with more steps added to the pipeline this can become
intransparent. To simplify building complex pipelines, Julearn provides a
<a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> which helps keeping things neat.</p>
</section>
<section id="pipeline-specification-made-easy-with-the-pipelinecreator">
<span id="pipeline-creator"></span><h2>Pipeline specification made easy with the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a><a class="headerlink" href="#pipeline-specification-made-easy-with-the-pipelinecreator" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> is a class that helps the user create complex
pipelines, but with straightforward usage.</p>
<p>Lets re-write the previous example, using the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a>.</p>
<p>We first start by creating an instance of the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a>, and
setting the <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">classification</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we just use the <code class="docutils literal notranslate"><span class="pre">add</span></code> method to add the desired steps to the pipeline.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pca&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We then pass the <code class="docutils literal notranslate"><span class="pre">creator</span></code> to <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> as the
<code class="docutils literal notranslate"><span class="pre">model</span></code> parameter. We do not need to (and cannot) specify the <code class="docutils literal notranslate"><span class="pre">preprocess</span></code>
parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Awesome! We covered how to create a basic machine learning pipeline and
even added multiple feature pre-preprocessing steps.</p>
<p>Let’s jump to the next important aspect in the process of building a machine
learning model: <strong>Hyperparameters</strong>. We here cover the basics of setting
hyperparameters. If you want to know more about tuning (or optimizing)
hyperparameters, please have a look at <a class="reference internal" href="../selected_deeper_topics/HPT.html#hp-tuning"><span class="std std-ref">Hyper Parameter Tuning</span></a>.</p>
</section>
<section id="how-to-specify-hyperparameters">
<h2>How to specify hyperparameters<a class="headerlink" href="#how-to-specify-hyperparameters" title="Permalink to this heading">#</a></h2>
<p>If you are new to machine learning, the section heading might confuse you:
Parameters, hyperparameters - aren’t we doing machine learning, so shouldn’t
the model learn all our parameters? Well, yes and no. Yes, it should learn
parameters. However, hyperparameters and parameters are two different things.</p>
<p>A <strong>model parameter</strong> is a variable that is internal to the learning
algorithm and we want to learn or estimate its value from the data, which in
turn means that they are not set manually. They are required by the model and
are often saved as part of the fitting process. Examples of model parameters
are the weights in an artificial neural network, the support vectors in a
support vector machine or the coefficients/weights in a linear or logistic
regression.</p>
<p><strong>Hyperparameters</strong> in turn, are _configuration(s)_ of a learning algorithm,
which cannot be estimated from data, but nevertheless need to be specified to
help estimate the model parameters. The best value for a hyperparameter on a
given problem is usually not known and therefore has to be either set manually,
based on experience from a previous similar problem, set by using a
heuristic (rule of thumb) or by being _tuned_. Examples are the learning rate
for training a neural network, the <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma</span></code> hyperparameters for
support vector machines or the number of estimators in a random forest.</p>
<p>Manually specifying hyperparameters with Julearn is as simple as using the
<a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> and add or change hyperparameters for each step in the
pipeline.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span> <span class="n">with_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">)</span>

<span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Usable transformers or estimators can be seen under
<a class="reference internal" href="../available_pipeline_steps.html#available-pipeline-steps"><span class="std std-ref">Overview of available Pipeline Steps</span></a>. The basis for most of these steps are the
respective scikit-learn estimators or transformers. To see the valid
hyperparameters for a certain transformer or estimator, just follow the
respective link in <a class="reference internal" href="../available_pipeline_steps.html#available-pipeline-steps"><span class="std std-ref">Overview of available Pipeline Steps</span></a> which will lead you to the
<a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> documentation where you can read more about the respective
hyperparameters.</p>
<p>In many cases one wants to specify more than one hyperparameter. This can be
done by passing each hyperparameter separated by a comma. For the ‘svm’ we could
for example specify the ‘C’ and the kernel hyperparameter like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="p">(</span><span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
         <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span> <span class="n">with_mean</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">])</span>
         <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="p">[</span><span class="mf">.2</span><span class="p">])</span>
         <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="p">[</span><span class="mf">.9</span><span class="p">],</span> <span class="n">kernel</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">])</span>
        <span class="p">)</span>

<span class="n">run_cross_validation</span><span class="p">(</span>
  <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
  <span class="n">model</span><span class="o">=</span><span class="n">creator</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="applying-preprocessing-only-to-certain-feature-types">
<span id="apply-to-feature-types"></span><h2>Applying preprocessing only to certain feature types<a class="headerlink" href="#applying-preprocessing-only-to-certain-feature-types" title="Permalink to this heading">#</a></h2>
<p>Under <a class="reference internal" href="#pipeline-creator"><span class="std std-ref">Pipeline specification made easy with the PipelineCreator</span></a> you might have wondered, how the
<a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> makes things easier. Beside the very straight forward
definition of hyperparameters, the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> also helps to apply
certain steps of the pipeline only to pre-defined types of data (see
<a class="reference internal" href="data.html#data-usage"><span class="std std-ref">Data</span></a> on how to pre-define types of data). This can be useful,
for example, when one wants to apply a preprocessing step only to a certain
type of feature, like for example continous features. We here exemplarily
apply a _PCA_ only to the _petal_ features of the _iris_ dataset.</p>
<p>First, one needs to define the <code class="docutils literal notranslate"><span class="pre">X_types</span></code> to which the <code class="docutils literal notranslate"><span class="pre">pca</span></code> should be
applied:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_types</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;petal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;petal_length&quot;</span><span class="p">,</span> <span class="s2">&quot;petal_width&quot;</span><span class="p">]}</span>
</pre></div>
</div>
<p>Next, in the <a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a>, we specify the <code class="docutils literal notranslate"><span class="pre">apply_to</span></code> parameter
at the respective step of the pipeline (in our case the <code class="docutils literal notranslate"><span class="pre">pca</span></code>) that it should
only be applied to these <code class="docutils literal notranslate"><span class="pre">X_types</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="s2">&quot;petal&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we again pass the defined <code class="docutils literal notranslate"><span class="pre">X_types</span></code> and the <code class="docutils literal notranslate"><span class="pre">creator</span></code> to
<a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In a slightly more complex use-case, one might want to <code class="docutils literal notranslate"><span class="pre">z-score</span></code> all features
and apply a <code class="docutils literal notranslate"><span class="pre">pca</span></code> only to the ‘petal’ features. The <code class="docutils literal notranslate"><span class="pre">apply-to</span></code> parameter
can also receive a list of <code class="docutils literal notranslate"><span class="pre">X_types</span></code>. To demonstrate this we split the
features in two different types: <code class="docutils literal notranslate"><span class="pre">petal</span></code> and <code class="docutils literal notranslate"><span class="pre">sepal</span></code>. This also shows that
<code class="docutils literal notranslate"><span class="pre">X_types</span></code> is a dictionary in which one can specify as many different
<code class="docutils literal notranslate"><span class="pre">X_types</span></code> as wished in a key-value manner. The key is the name of the type
and the value a list of column-names in the features that should belong to
this type. Splitting the <code class="docutils literal notranslate"><span class="pre">petal</span></code> columns in two different <code class="docutils literal notranslate"><span class="pre">X_types</span></code> is not
necessary and only for demonstration purposes. We here only want to
use the first component of the <code class="docutils literal notranslate"><span class="pre">pca</span></code> and therfore specify its <code class="docutils literal notranslate"><span class="pre">n_components</span></code>
hyperparameter respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_types</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;petal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;petal_length&quot;</span><span class="p">,</span> <span class="s2">&quot;petal_width&quot;</span><span class="p">],</span>
    <span class="s2">&quot;sepal&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span> <span class="s2">&quot;sepal_width&quot;</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">creator</span> <span class="o">=</span> <span class="n">PipelineCreator</span><span class="p">(</span><span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;zscore&quot;</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;petal&quot;</span><span class="p">,</span> <span class="s2">&quot;sepal&quot;</span><span class="p">])</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="s2">&quot;petal&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">creator</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">)</span>

<span class="n">run_cross_validation</span><span class="p">(</span>
    <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">X_types</span><span class="o">=</span><span class="n">X_types</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">creator</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="applying-preprocessing-to-the-target">
<h2>Applying preprocessing to the target<a class="headerlink" href="#applying-preprocessing-to-the-target" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>So far we only applied preprocessing ot the features</p></li>
<li><p>all transformers in (ref transfomers) cann be used both for feature and targettransfomrations,</p></li>
<li><p>but when used for target transformations, the TargetPipelineCreator has to be used</p></li>
<li><p>The target creator is than passed to the general pipeline creatro following the general principle of
using apply_to to add everything to the general pipelinCreagor and create one big pipeline</p></li>
</ul>
<p>&lt;fill-in example for target preprocessing&gt;</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This approach refered to using the <cite>:class:</cite>.PipelineCreator` for feature
preprocessing and model definitions. To see how to preprocess targets within
a pipeline have a look at ref <cite>target_preprocessing</cite>.</p>
</div>
<p>We covered how to set up basic pipelines, how to use the
<a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a>, how to use the <code class="docutils literal notranslate"><span class="pre">apply_to</span></code> parameter of the
<a class="reference internal" href="../api/generated/julearn.PipelineCreator.html#julearn.PipelineCreator" title="julearn.PipelineCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a> and covered basics of hyperparameters. In the next
step we will understand the returns of <a class="reference internal" href="../api/generated/julearn.run_cross_validation.html#julearn.run_cross_validation" title="julearn.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a>, i.e. the
model output and the scores of the performed corss-validation.</p>
<aside class="topic">
<p class="topic-title">References:</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">2</a><span class="fn-bracket">]</span></span>
<p>Boser, B. E., Guyon, I. M., &amp; Vapnik, V. N., <a class="reference external" href="https://dl.acm.org/doi/pdf/10.1145/130385.130401">“A training algorithm for optimal margin classifiers”</a>, COLT ‘92 Proceedings of the fifth annual workshop on Computational learning theory. 1992 Jul; 144-152.</p>
</aside>
</aside>
</aside>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="model_evaluation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">2.4. </span>Model evaluation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">2.2. </span>Data</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Authors of julearn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">2.3. Pipeline</a><ul>
<li><a class="reference internal" href="#basic-cross-validation-with-julearn">Basic cross validation with Julearn</a></li>
<li><a class="reference internal" href="#feature-preprocessing">(Feature) preprocessing</a></li>
<li><a class="reference internal" href="#pipeline-specification-made-easy-with-the-pipelinecreator">Pipeline specification made easy with the <code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineCreator</span></code></a></li>
<li><a class="reference internal" href="#how-to-specify-hyperparameters">How to specify hyperparameters</a></li>
<li><a class="reference internal" href="#applying-preprocessing-only-to-certain-feature-types">Applying preprocessing only to certain feature types</a></li>
<li><a class="reference internal" href="#applying-preprocessing-to-the-target">Applying preprocessing to the target</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom.js"></script>
    </body>
</html>