<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Understanding the pipeline &mdash; julearn  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Scoring" href="scoring.html" />
    <link rel="prev" title="Input Data" href="input.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/julearn_logo_it.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installing julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input Data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Understanding the pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-problem-type">Model &amp; Problem Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concepts">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-information">More information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-returned-pipeline">The returned pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#returning-the-extended-pipeline">Returning the (extended) pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extendeddataframepipeline">ExtendedDataFramePipeline</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#where-extendeddataframepipeline-behave-as-usual">Where ExtendedDataFramePipeline behave as usual</a></li>
<li class="toctree-l4"><a class="reference internal" href="#caveats-extendeddataframepipeline">Caveats ExtendedDataFramePipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-functionality">Additional functionality</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="scoring.html">Scoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="steps.html">Available Pipeline Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperparameters.html">Hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/basic/index.html">Basic Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/advanced/index.html">Advanced Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="maintaining.html">Maintaining julearn</a></li>
<li class="toctree-l1"><a class="reference internal" href="whats_new.html">What’s new</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">julearn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Understanding the pipeline</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pipeline.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="understanding-the-pipeline">
<h1>Understanding the pipeline<a class="headerlink" href="#understanding-the-pipeline" title="Permalink to this heading"></a></h1>
<p>Julearn aims to provide an user-friendly way to apply complex machine learning
pipelines.
To do so julearn provides the <a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> function.
Here, users can specify and customize their pipeline,
how should be fitted and evaluated.
Furthermore, this function allows you to return the
complete and fitted pipeline to use it on other data.
In this part of the documentation we will have a closer look to these
features of julearn and how you can use them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should have read the <a class="reference internal" href="input.html"><span class="doc">input</span></a> section before.</p>
</div>
<section id="model-problem-type">
<h2>Model &amp; Problem Type<a class="headerlink" href="#model-problem-type" title="Permalink to this heading"></a></h2>
<dl>
<dt>When using <a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> you have to answer at least</dt><dd><p>2 questions first and then specify the according arguments properly:</p>
<blockquote>
<div><ul class="simple">
<li><p>What model do you want to use?
You can enter any model name from <a class="reference internal" href="steps.html"><span class="doc">steps</span></a>
or use any scikit-learning compatible model into the <cite>model</cite>
argument from <a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a></p></li>
<li><p>What problem type do you want to answer?
In machine learning their are different problems you want to handle.
Julearn supports <code class="docutils literal notranslate"><span class="pre">classification</span></code> and <code class="docutils literal notranslate"><span class="pre">regression</span></code> problems.
You shout set <code class="docutils literal notranslate"><span class="pre">problem_type</span></code> to one of these
2 problem types. By default, julearn uses the <code class="docutils literal notranslate"><span class="pre">classification</span></code>
type.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>What model do you want to use and what problem type do you want to use
machine learning on.</p>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading"></a></h2>
<section id="concepts">
<h3>Concepts<a class="headerlink" href="#concepts" title="Permalink to this heading"></a></h3>
<p>By default users do not have to specify how to preprocess their data.
In this case, julearn automatically standardizes the continuous features,
the confounds and removes existing confound from the continuous features.</p>
<p>But users can configure <a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> by specifying
the 3 preprocessing arguments for transforming the
confounds, target and features respectively (in this order).</p>
<p>To do so you can set the following arguments in the
<a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> :</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_X</span></code>: specifies how to transform the features.
Here, you can enter the names or a list of the names of available
transformers (<a class="reference internal" href="steps.html"><span class="doc">steps</span></a> ).
These are then applied in order to the features.
By default most transformers are applied only to the continuous features.
For more information on this and how to modify this behavior see below.</p>
<p>E.g. <code class="docutils literal notranslate"><span class="pre">['zscore',</span> <span class="pre">'pca']</span></code> would mean that the (continuous) features are
first z-standardized and then reduced using a principle component analysis.
By default features will will not be preprocessed and confound removed in
case a confound was specified.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_confounds</span></code>: specifies how to transform the confounds.
Here, you use the same lists of available transformers as in
<code class="docutils literal notranslate"><span class="pre">preprocess_X</span></code>. By default confounds will not be preprocessed.</p></li>
</ul>
</div></blockquote>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<p>Assume we want not preprocess the confounds, zscore the transformer
and then use a pca on the features before removing the confound from these
features. All of these operations are included in the <a class="reference internal" href="steps.html"><span class="doc">steps</span></a>
and can therefore be referred to by name.</p>
<dl class="simple">
<dt>In other words we need to set:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_target</span> <span class="pre">=</span> <span class="pre">'zscore'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_X</span> <span class="pre">=</span> <span class="pre">['pca',</span> <span class="pre">'remove_confound']</span></code></p></li>
</ul>
</dd>
</dl>
<p>Additionally, we know that we are facing a multiclass classification problem
and want to use a svm model.
Put together with an example from the <a class="reference internal" href="input.html"><span class="doc">input</span></a> the code looks
like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">seaborn</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">julearn</span> <span class="kn">import</span> <span class="n">run_cross_validation</span>

<span class="n">df_iris</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;species&#39;</span>
<span class="n">confounds</span> <span class="o">=</span> <span class="s1">&#39;petal_width&#39;</span>

<span class="n">preprocess_confounds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">preprocess_target</span> <span class="o">=</span> <span class="s1">&#39;zscore&#39;</span>
<span class="n">preprocess_X</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pca&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_confound&#39;</span><span class="p">]</span>
<span class="n">run_cross_validation</span><span class="p">(</span>
  <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_iris</span><span class="p">,</span> <span class="n">confounds</span><span class="o">=</span><span class="n">confounds</span><span class="p">,</span>
  <span class="n">model</span><span class="o">=</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span> <span class="n">problem_type</span><span class="o">=</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span>
  <span class="n">preprocess_X</span><span class="o">=</span><span class="n">preprocess_X</span><span class="p">,</span>
  <span class="n">preprocess_confounds</span><span class="o">=</span><span class="n">preprocess_confounds</span><span class="p">,</span>
  <span class="n">preprocess_target</span><span class="o">=</span><span class="n">preprocess_target</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of using the name of the available transformers you can also use
scikit-learn compatible transformers.
But it is recommended to register your own transformers first.
For more information see (#TODO)</p>
</div>
</section>
<section id="more-information">
<h3>More information<a class="headerlink" href="#more-information" title="Permalink to this heading"></a></h3>
<p>As mentioned above julearn allows the user to specify to which variable/columns
or variable/column types each transformer will be applied. To do so you
can adjust the <code class="docutils literal notranslate"><span class="pre">apply_to</span></code> hyperparameter which is added to all transformers
used in <code class="docutils literal notranslate"><span class="pre">preprocess_X</span></code>. You can find such an example at #TODO
and find more information on hyperparameter tuning in
<a class="reference internal" href="hyperparameters.html"><span class="doc">hyperparameters</span></a> .</p>
</section>
</section>
<section id="the-returned-pipeline">
<h2>The returned pipeline<a class="headerlink" href="#the-returned-pipeline" title="Permalink to this heading"></a></h2>
<p>The <a class="reference internal" href="api.html#julearn.api.run_cross_validation" title="julearn.api.run_cross_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">run_cross_validation()</span></code></a> uses all the information mentioned above
to create one <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code> which is then used for
cross_validation. Additionally, it can return the fitted pipeline for other
application. E.g. you could want to test the pipeline on one additional
test set. But how can you do that?</p>
<section id="returning-the-extended-pipeline">
<h3>Returning the (extended) pipeline<a class="headerlink" href="#returning-the-extended-pipeline" title="Permalink to this heading"></a></h3>
<p>There are multiple options which you can use to return the pipeline(s).
For all of them you have to set the <cite>return_estimator</cite>.
These are the possible options:</p>
<blockquote>
<div><ul class="simple">
<li><p>None: Does not return any estimator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'final'</span></code>: Return the estimator fitted on all the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cv'</span></code>: Return the all the estimator from each CV split, fitted on the
training data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'all'</span></code>: Return all the estimators (final and cv).</p></li>
</ul>
</div></blockquote>
<p>These returned estimators are always <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code>
objects.Therefore, the next section will discuss how you can use
a returned estimator.</p>
</section>
<section id="extendeddataframepipeline">
<h3>ExtendedDataFramePipeline<a class="headerlink" href="#extendeddataframepipeline" title="Permalink to this heading"></a></h3>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code> has the same basic functionality as
all scikit-learn pipelines or estimators, but also has some caveats.</p>
<section id="where-extendeddataframepipeline-behave-as-usual">
<h4>Where ExtendedDataFramePipeline behave as usual<a class="headerlink" href="#where-extendeddataframepipeline-behave-as-usual" title="Permalink to this heading"></a></h4>
<p>The following methods work as in sklearn:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.fit()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.predict()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.score()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.predict_proba()</span></code></p></li>
</ul>
</div></blockquote>
</section>
<section id="caveats-extendeddataframepipeline">
<h4>Caveats ExtendedDataFramePipeline<a class="headerlink" href="#caveats-extendeddataframepipeline" title="Permalink to this heading"></a></h4>
<p>In contrast to scikit-learn pipelines <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code>
can change the ground truth (transform the target).
This means that any any function which uses sklearn scorer functions instead of
calling <code class="docutils literal notranslate"><span class="pre">.score()</span></code> on the <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code> can give you
the wrong output without <strong>any warning</strong>.
For example <cite>cross_validate</cite> function of sklearn when using another scorer.</p>
<p>If you want to use such functions, you can follow this example (#TODO) which
shows how to use julearns <code class="docutils literal notranslate"><span class="pre">extended_scorer</span></code> instead</p>
</section>
<section id="additional-functionality">
<h4>Additional functionality<a class="headerlink" href="#additional-functionality" title="Permalink to this heading"></a></h4>
<p>Furthermore, <code class="xref py py-class docutils literal notranslate"><span class="pre">ExtendedDataFramePipeline</span></code>  have the following
added methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess</span></code>: a method to apply preprocessing steps of the pipeline to
some data. Furthermore, the <code class="docutils literal notranslate"><span class="pre">until</span></code> argument can be used to
only preprocess up to a specific transformer.</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="input.html" class="btn btn-neutral float-left" title="Input Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="scoring.html" class="btn btn-neutral float-right" title="Scoring" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Authors of julearn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CB4ETK4DBG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-CB4ETK4DBG', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>